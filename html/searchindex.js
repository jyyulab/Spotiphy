Search.setIndex({"docnames": ["Spotiphy_tutorial_1", "_contributors", "index", "install", "questions", "tutorials"], "filenames": ["Spotiphy_tutorial_1.ipynb", "_contributors.rst", "index.rst", "install.rst", "questions.rst", "tutorials.rst"], "titles": ["Deconvolution and decomposition of Visium data with Spotiphy", "&lt;no title&gt;", "Spotiphy!", "Installation", "Frequently Asked Questions", "Tutorials"], "terms": {"ziqian": [0, 1, 2], "zheng": [0, 1, 2], "author": [1, 2], "method": [1, 2, 3], "pypi": [1, 2, 3], "maintain": [1, 2], "contact": [1, 2], "zzheng92": [0, 1, 2], "wisc": [0, 1, 2], "edu": [0, 1, 2], "jiyuan": [0, 1, 2], "yang": [0, 1, 2], "stjude": [0, 1, 2], "org": [0, 1, 2], "To": [0, 3], "make": [], "sure": [], "you": [0, 3], "have": [], "pytorch": 3, "scanpi": 0, "If": 0, "need": [0, 4], "more": [0, 3], "detail": 0, "depend": [0, 3], "look": [], "environ": [0, 3], "yml": [], "file": 0, "from": [0, 3], "shell": [], "pip": [0, 3], "sc": 0, "creat": [0, 3], "conda": 3, "env": 3, "activ": 3, "import": [0, 3], "tg": [], "Then": 0, "load": 5, "your": [], "spatial": 5, "data": 5, "singl": 5, "which": [0, 3], "should": 0, "anndata": [], "format": [], "pre": [], "process": [0, 4], "them": [], "us": 0, "pp_adata": [], "ad_sp": [], "read_h5ad": 0, "path": 0, "ad_sc": [], "gene": 5, "none": 0, "The": 0, "function": 0, "find": 0, "common": 0, "between": [], "adata_sc": 0, "adata_sp": [], "save": 0, "two": 3, "adata": [], "un": [], "map": [], "analysi": [], "later": [], "also": 0, "subset": [], "intersect": [], "set": [], "train": [], "pass": [], "all": 0, "share": [], "dataset": [], "onc": [], "ar": [0, 4], "we": [0, 3], "can": 0, "ad_map": [], "map_cells_to_spac": [], "return": [], "i": [0, 3, 4], "voxel": [], "structur": [], "where": [], "x": 0, "j": [], "give": [], "probabl": [], "thi": [0, 3], "project": [], "express": 5, "space": [], "achiev": [], "via": 0, "project_gen": [], "ad_g": [], "similar": [], "ha": [], "been": [], "allow": 3, "extend": 0, "throughput": [], "correct": [], "dropout": [], "higher": [], "qualiti": [], "than": 0, "It": [], "transfer": [], "type": [0, 4], "onto": [], "For": 0, "how": [], "check": [], "out": 0, "our": 4, "tutori": [], "enabl": [], "faster": [], "consum": [], "less": [], "memori": [], "done": [], "prepar": 0, "input": [], "same": [], "would": [], "do": 4, "follow": 0, "code": [0, 3], "mode": [], "cluster_label": [], "subclass_label": [], "provid": 0, "must": [], "belong": [], "ob": 0, "abov": [], "exampl": 0, "argument": 0, "label": 0, "gpu": 4, "run": 4, "tangram": [], "A": 4, "requir": [], "recommend": [3, 4], "most": 4, "p100": [], "50k": [], "cell": [4, 5], "few": [], "minut": 4, "choos": [], "list": 0, "good": [], "wai": [], "start": [], "top": [], "1k": [], "uniqu": 0, "marker": 5, "stratifi": [], "across": [], "altern": [], "whole": [], "transcriptom": [], "ideal": [], "contain": [], "high": [], "signal": [], "rich": [], "obtain": 0, "bad": [], "rna": [], "probe": [], "accur": [], "segment": 5, "visium": 5, "histologi": [], "includ": [0, 3], "slide": [], "seq": [], "howev": [], "wish": 3, "deconvolv": [], "_ie_": [], "determinist": [], "assign": 0, "profil": [], "each": 5, "within": [0, 4], "when": 0, "what": [], "reduc": [], "variou": [], "part": [], "suffici": [], "downsampl": [], "well": [], "jiyuna": 0, "last": 0, "updat": 0, "nov": 0, "29th": 0, "2023": 0, "re": 0, "local": 0, "pleas": 0, "ensur": 0, "correctli": 0, "instruct": 0, "its": 0, "github": [0, 3], "page": 0, "googl": 0, "colab": 0, "execut": [0, 4], "block": 0, "get": 0, "enough": 0, "ram": 0, "pro": 0, "might": 0, "first": 0, "time": 0, "mai": 0, "an": 0, "error": 0, "inconsist": 0, "version": [0, 3], "like": 0, "": 0, "resolv": 0, "doe": 0, "current": 0, "take": 0, "account": 0, "behaviour": 0, "sourc": [0, 3], "conflict": [0, 3], "solv": 0, "issu": 0, "simpli": 0, "ignor": 0, "restart": 0, "runtim": 0, "abl": 0, "1": [0, 3], "sy": 0, "in_colab": 0, "modul": 0, "qq": 0, "o": 0, "pickl": 0, "numpi": 0, "np": 0, "panda": 0, "pd": 0, "matplotlib": 0, "mpl": 0, "torch": 0, "cv2": 0, "results_fold": 0, "result": 0, "mouse_brain": 0, "exist": 0, "folder": 0, "makedir": 0, "correspond": 0, "h": 0, "e": 0, "stain": 0, "2": [0, 3], "scrna_mouse_brain": 0, "h5ad": 0, "adata_st": 0, "st_mouse_brain": 0, "adata_sc_orig": 0, "copi": 0, "adata_st_orig": 0, "img": 0, "imread": 0, "img_mouse_brain": 0, "png": 0, "key_typ": 0, "celltyp": 0, "type_list": 0, "sort": 0, "print": 0, "f": 0, "There": 0, "len": 0, "14": 0, "39": 0, "astro": 0, "ca": 0, "dg": 0, "l2": 0, "3": [0, 3], "IT": 0, "ctx": 0, "l4": 0, "5": [0, 4], "l5": 0, "pt": 0, "6": 0, "l6": 0, "ct": 0, "l6b": 0, "microglia": 0, "oligo": 0, "sub": 0, "fig": 0, "ax": 0, "pyplot": 0, "subplot": 0, "figsiz": 0, "20": 0, "pl": 0, "color": 0, "in_tissu": 0, "frameon": 0, "fals": 0, "show": 0, "0": [0, 3], "umap": 0, "size": 0, "10": 0, "imshow": 0, "In": 0, "default": 0, "bgr": 0, "so": 0, "convert": 0, "rgb": 0, "axi": 0, "off": 0, "tight_layout": 0, "scatterplot": 0, "py": 0, "392": 0, "No": 0, "colormap": 0, "c": 0, "paramet": 0, "cmap": 0, "initi": 0, "trancriptom": 0, "specif": 0, "normal": 0, "filter": 0, "onli": 0, "kept": 0, "4": 0, "verbos": 0, "matrix": 0, "arrai": 0, "06": 0, "96": 0, "54": 0, "05": 0, "base": [0, 3], "pairwis": 0, "statist": 0, "test": [0, 3], "csv": 0, "user": [0, 3], "adjust": 0, "n_select": 0, "maximum": 0, "threshold_p": 0, "threshold": 0, "p": 0, "valu": 0, "consid": 0, "signific": 0, "threshold_fold": 0, "fold": 0, "chang": 0, "q": 0, "sinc": 0, "one": 0, "quantil": 0, "addit": 0, "refer": 0, "supplementari": 0, "materi": 0, "paper": 0, "marker_gene_dict": 0, "sc_refer": 0, "marker_select": 0, "return_dict": 0, "true": 0, "50": 0, "15": 0, "marker_gen": 0, "marker_gene_label": 0, "type_": 0, "marker_gene_df": 0, "datafram": 0, "to_csv": 0, "construct": 0, "single_cel": 0, "visual": 0, "sc_ref": 0, "construct_sc_ref": 0, "plot_heatmap": 0, "out_dir": 0, "14it": 0, "00": 0, "358": 0, "97it": 0, "perform": [0, 4], "calcul": 0, "posterior": 0, "distribut": 0, "certain": 0, "probabilist": 0, "model": 0, "pyro": 0, "http": [0, 3], "ai": 0, "__": 0, "7": 0, "devic": 0, "cuda": [0, 3], "is_avail": 0, "els": 0, "cpu": 0, "cell_proport": 0, "estimation_proport": 0, "n_epoch": 0, "8000": 0, "plot": 0, "batch_prior": 0, "proport": 0, "npy": 0, "futur": 0, "usag": 0, "100": 0, "24": 0, "lt": 0, "68it": 0, "2272758115": 0, "try": [0, 3], "modifi": 0, "attribut": 0, "view": 0, "actual": 0, "8": 0, "vmax": 0, "98": 0, "rc_context": 0, "figur": 0, "dpi": 0, "400": 0, "xtick": 0, "labels": 0, "viridi": 0, "img_kei": 0, "hire": 0, "vmin": 0, "ncol": 0, "alpha_img": 0, "get_figur": 0, "savefig": 0, "jpg": 0, "stardist": 0, "nuclei": 0, "count": 0, "9": [0, 3], "obsm": 0, "n_tile": 0, "segment_nucleu": 0, "n_cell_df": 0, "suppress": 0, "output": 0, "tensorflow": 0, "predict": 0, "12": 0, "gt": 0, "found": 0, "2d_versatile_h": 0, "stardist2d": 0, "network": 0, "weight": 0, "weights_best": 0, "h5": 0, "json": 0, "prob_thresh": 0, "692478": 0, "nms_thresh": 0, "08": 0, "small": 0, "section": 0, "examin": 0, "crop": 0, "2000": 0, "2500": 0, "1000": 0, "1500": 0, "segmentation_sampl": 0, "class": 0, "11": 0, "open": 0, "pkl": 0, "wb": 0, "dump": 0, "adata_st_decompos": 0, "spot_loc": 0, "filtering_gen": 0, "n_cell": 0, "cell_count": 0, "filenam": 0, "st_decomposit": 0, "st": 0, "36": 0, "58it": 0, "07": 0, "complet": 0, "93": 0, "02": 0, "30": [0, 4], "As": 0, "infer": 0, "boundari": 0, "13": 0, "search_direct": 0, "boundary_dict": 0, "cell_boundari": 0, "nucleus_df": 0, "y": 0, "img_siz": 0, "shape": 0, "max_dist": 0, "25": 0, "max_area": 0, "580": 0, "delta": 0, "4100": 0, "339": 0, "47it": 0, "dictionari": 0, "tissu": 0, "three": 0, "step": 0, "proportion_to_count": 0, "comput": 0, "outcom": 0, "assign_type_spot": 0, "cell_proportion_smooth": 0, "alloc": 0, "locat": 0, "outsid": 0, "cell_numb": 0, "multiple_spot": 0, "assign_type_out": 0, "spot_cent": 0, "band_width": 0, "150": 0, "defin": 0, "plot_visium": 0, "legend": 0, "21": 0, "plot_legend": 0, "now": 0, "specifi": 0, "ad": 0, "nucleu": 0, "circl": 0, "group": 0, "both": 0, "want": 0, "insid": 0, "22": 0, "background": 0, "pseudo_image_in": 0, "spot_color": 0, "200": 0, "322": 0, "08it": 0, "19": 0, "46it": 0, "10747it": 0, "976986": 0, "11it": 0, "10747": 0, "219299": 0, "74it": 0, "without": 0, "23": 0, "pseudo_image_both_circl": 0, "141407": 0, "94it": 0, "1343512": 0, "42it": 0, "note": 0, "deconvolut": [4, 5], "decomposit": 5, "spotiphi": [3, 4, 5], "content": 5, "instal": 5, "packag": [3, 5], "scrna": 5, "select": 5, "estim": 5, "abund": 5, "spot": [4, 5], "number": 5, "decompos": 5, "level": 5, "gener": 5, "pseudo": 5, "resolut": 5, "imag": 5, "separ": 3, "approach": 3, "help": 3, "manag": 3, "avoid": 3, "other": 3, "n": 3, "python": 3, "built": 3, "although": 3, "automat": 3, "manual": 3, "link": 3, "flexibl": 3, "particularli": 3, "those": 3, "who": 3, "util": 3, "capabl": [3, 4], "offer": 3, "latest": 3, "directli": 3, "host": 3, "git": 3, "com": 3, "jyyulab": 3, "index": 3, "streamlin": 3, "prefer": 3, "standard": 3, "option": 4, "optim": 4, "analys": 4, "nvidia": 4, "quadro": 4, "rtx": 4, "6000": 4, "4000": 4}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"contributor": [1, 2], "get": [], "start": [], "instal": [0, 3], "tangram": [], "run": [], "cell": 0, "level": 0, "cluster": [], "spotiphi": [0, 2], "frequent": 4, "ask": 4, "question": 4, "tutori": 5, "deconvolut": 0, "decomposit": 0, "visium": 0, "data": 0, "content": 0, "load": 0, "packag": 0, "scrna": 0, "select": 0, "marker": 0, "gene": 0, "estim": 0, "abund": 0, "spatial": 0, "spot": 0, "segment": 0, "number": 0, "each": 0, "decompos": 0, "express": 0, "singl": 0, "gener": 0, "pseudo": 0, "resolut": 0, "imag": 0}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 60}, "alltitles": {"Contributors": [[1, null], [2, null]], "Deconvolution and decomposition of Visium data with Spotiphy": [[0, "Deconvolution-and-decomposition-of-Visium-data-with-Spotiphy"]], "Contents": [[0, "Contents"]], "Install and load packages": [[0, "Install-and-load-packages"]], "Load Visium and scRNA data": [[0, "Load-Visium-and-scRNA-data"]], "Select marker genes for the deconvolution": [[0, "Select-marker-genes-for-the-deconvolution"]], "Deconvolution: Estimate cell abundance in spatial spots": [[0, "Deconvolution:-Estimate-cell-abundance-in-spatial-spots"]], "Segmentation: Estimate cell number in each spatial spot": [[0, "Segmentation:-Estimate-cell-number-in-each-spatial-spot"]], "Decomposition: Decompose the expression of each spatial spot into single-cell level": [[0, "Decomposition:-Decompose-the-expression-of-each-spatial-spot-into-single-cell-level"]], "Generate pseudo single-cell resolution image": [[0, "Generate-pseudo-single-cell-resolution-image"]], "Tutorials": [[5, "tutorials"]], "Frequently Asked Questions": [[4, "frequently-asked-questions"]], "Spotiphy!": [[2, "spotiphy"]], "Installation": [[3, "installation"]]}, "indexentries": {}})